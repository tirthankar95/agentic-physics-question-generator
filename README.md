# Physics Word Problem Generation

Generate high-quality, diverse physics word problems using LLMs and agentic Retrieval-Augmented Generation (RAG) with Qdrant vector database.

## Folder Structure

- **DATASET**: Saved physics questions by topic generated by our methodology.
- **FINE_TUNE_GPT2**: GPT-2 fine tuning code.
- **LLM**: RAG chains for question generation.
- **LLM_CONFIG**: LLM selection/configuration.
    - `BUILD_DATASET`: Save generated questions if true.
    - `OPENAI_API_KEY`: OpenAI API key. It's advisable to use your own OPENAI_API_KEY for beignners to try out the code.
    - `INNER_MODEL`: OpenAI model name.
- **NOVELTY_SCORE**: Novelty score calculation.
- **TOPICS**: Topic equations.
- **UTILS**: Utility functions.

## Agentic RAG with Qdrant

This project uses an agentic RAG pipeline to iteratively retrieve and refine context chunks from a Qdrant vector database. The agent interacts with Qdrant, evaluates chunk relevance, and improves retrieval over multiple steps to maximize question quality and topic coverage.

- **Qdrant**: Stores vectorized textbook and question bank chunks.
- **Agentic RAG**: The agent queries Qdrant, analyzes retrieved chunks, and adapts its strategy to get better context for question generation.
- **Iterative Retrieval**: Each round, the agent refines its queries and chunk selection, leading to more accurate and novel physics questions.

## Architecture Diagram
![Options](src/Architecture.png)

## How to Run
`main.py` is the main entry point. 
Currently we have added the following topics.(see picture below) 

```bash
python main.py
```
![Image of topic-selection](src/terminal1.png)

If the code doesn't run due to some collections error, remove the `QdrantDB` folder.

The config file(config.yaml, shown below) is where the main program reads the configuration.

<img src="src/config.png" alt="Image of config file" style="width:480px;"/>

- The section highlighted as **(1)** indicates where you add a new topic. You can control how many questions you generate at one go by controlling `Trials`. 
- The section highlighted as **(2)** is where the configuration for each topic is loaded, along with the LLM configuration file (e.g., API keys and model name).  
- The section highlighted as **(3)** shows the directory where outputs are saved. Enabling `BUILD` allows you to add new questions to the dataset.  
- The section highlighted as **(4)** enables Monte Carlo, value-based updates of Q-functions in the reinforcement learning pipeline.

If `Train` is enabled you'll get a prompt at the end(shown in yellow)

<img src="src/terminal2.png" alt="Image of rl-reward input" style="width:640px;"/>

You can specify a reward to balance solvability and novelty according to your preference.
## Citation

If you use this codebase, please cite or acknowledge appropriately.
For questions or suggestions, open an issue or contact the maintainer.

---
